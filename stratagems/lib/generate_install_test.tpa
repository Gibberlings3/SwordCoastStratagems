DEFINE_ACTION_FUNCTION generate_install_test
BEGIN
   OUTER_SPRINT comp_list ""
   COPY "%scsroot%/setup-stratagems.tp2" "%workspace%"
      REPLACE_TEXTUALLY "DESIGNATED +[0-9]+ NO_LOG_RECORD" ""
      REPLACE_TEXTUALLY "DESIGNATED +[0-9]+ DEPRECATED" ""
      REPLACE_EVALUATE
      "DESIGNATED +\([0-9]+\) +GROUP +@[0-9]+ +SUBCOMPONENT @\([0-9]+\)"
      BEGIN
        PATCH_IF !VARIABLE_IS_SET $multicomponent("%MATCH2%") BEGIN
           SPRINT comp_list "%comp_list% %MATCH1%"
           SPRINT $multicomponent("%MATCH2%") ""
        END
      END
      ""
      REPLACE_EVALUATE
      "DESIGNATED +\([0-9]+\)" 
      BEGIN
        PATCH_IF MATCH1>0 BEGIN
          SPRINT comp_list "%comp_list% %MATCH1%"
        END
      END
      ""
   BUT_ONLY

<<<<<<<< .../stratagems_test.bat
setup-stratagems --language 0 --uninstall --force-install-list %comp_list%
>>>>>>>>
   DELETE + "stratagems_test.bat"
   COPY + ".../stratagems_test.bat" "stratagems_test.bat" EVALUATE_BUFFER


END