//////////////////////////////////////////////////////////////////////////////////
///
///   Script to give to a priest whose spells we don't know (but who can't buff)
///   In particular, applicable to PC clones
///
////////////////////////////////////////////////////////////////////////////////////////


//////////////////////////////////////////////////////////////////////////////////
///
///   Define actions (with no spell check)
///
////////////////////////////////////////////////////////////////////////////////////////
BEGIN LOOP(SSLBoolean\(scsargument1\)|| )
   INCLUDE FILE(%scsroot%/caster_shared/caster_definitions.ssl)
END LOOP

////////////////////////////////////////////////////////////////
/// Labelling, break-invisibility, hostile-undead, panic, etc
////////////////////////////////////////////////////////////////////////////////////////


INCLUDE FILE(%scsroot%/priest/ssl/main/preamble.ssl)


BEGIN_ACTION_DEFINITION
	Name(MoveIfEmpty)     // we're redefining this for the benefit of shapeshifters
	TRIGGER
		ActionListEmpty()
	ACTION
		RESPONSE #scsprob1
		EquipMostDamagingMelee()
		MoveToObject(scstarget)
END

//////////////////////////////////////////////////////////////////////////////////
////	Prep
//////////////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/priest/ssl/main/priestsetup.ssl)

//////////////////////////////////////////////////////////////////////////////////
////	If non-hostile, closedown - this script doesn't pretend to fight bad guys
//////////////////////////////////////////////////////////////////////////////////

IF
	!Allegiance(Myself,ENEMY)
	IgnoreBlock(IsPartyAlly)
THEN
	RESPONSE #100
		NoAction()
END

///////////////////////////////////////////////////////////////////////////
////	Flee Cloudkill spell
///////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/mage/ssl/generalblocks/fleecloud.ssl)

///////////////////////////////////////////////////////////////////////////
//	Melee
///////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/priest/ssl/meleeblocks/touchattack.ssl)
INCLUDE FILE(%scsroot%/priest/ssl/meleeblocks/standard_priest.ssl)


//////////////////////////////////////////////////////////////////////////
// Renew and retreat
//////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/priest/ssl/generalblocks/renew.ssl)

//////////////////////////////////////////////////////////////////////////
// Easiest-level block
//////////////////////////////////////////////////////////////////////////

DEFAULT TRIGGER()
INCLUDE FILE(%scsroot%/priest/ssl/generalblocks/easy.ssl)

//////////////////////////////////////////////////////////////////////////
// Look for PCs
//////////////////////////////////////////////////////////////////////////

DEFAULT TRIGGER()

INCLUDE FILE(%scsroot%/priest/ssl/generalblocks/chase.ssl)

////////////////////////////////////////////////////////////////////////////
// Core magic block
///////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/priest/ssl/priesttypes/standard_priest.ssl)

//////////////////////////////////////////////////////
///	If everyone is helpless, kill'em.
//////////////////////////////////////////////////////

IF
	See(NearestEnemyOf(Myself))
	BEGIN LOOP(scsloopvar||1;2;3;4;5;6)
		OR(3)
			!See(Playerscsloopvar)
			StateCheck(Playerscsloopvar,STATE_IMMOBILE)
			CheckStatGT(Playerscsloopvar,0,HELD)
	END LOOP
THEN
	RESPONSE #100
		AttackReevaluate(NearestEnemyOf(Myself),15)
END

DEFAULT TRIGGER()
INCLUDE FILE(%scsroot%/priest/ssl/generalblocks\closedown.ssl)
