<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>lib_sugar function library</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../doc/files/g3readme_cam_022916_dwedit.css" type="text/css" />
<link href="../../doc/files/g3icon.ico" rel="icon" type="image/bmp" />
</head>
<body>
<div id="container">
<div class="ribbon_bubble">
    <div class="ribbon_rectangle">
<h1>lib_sugar function library</h1>
</div>
    <div class="ribbon_triangle-l"></div>
    <div class="ribbon_triangle-r"></div>

<div class="section">
<p><strong>Dependencies:</strong> lib_fn, lib_tools</p>
</div>

<div class="ribbon_rectangle_h2"><h2>Description</h2> </div>
    <div class="ribbon_triangle_h2-l"></div>
    <div class="ribbon_triangle_h2-r"></div>

<div class="section">
<p></p><p>This contains SFO's syntactic sugar, used by 'include', 'run', and anonymous functions.</p><p></p>
</div>

<div class="ribbon_rectangle_h2"><h2>Public functions</h2> </div>
    <div class="ribbon_triangle_h2-l"></div>
    <div class="ribbon_triangle_h2-r"></div>

<div class="section">
<p><strong>sugar_apply(patch_only:i)=()</strong> patch<br></p><p>
Apply SFO's syntactic sugar to the current file. If 'patch_only' is set to 1, don't bother with the action parts.
</p>
<p><strong>sugar_semicolons()=()</strong> patch<br></p><p>
Replace double semicolons with line breaks. </p><p></p>
<p><strong>sugar_test()=()</strong> action<br></p><p>
Copy over the inline file 'sugartest.tp2' (at the end of this library) and apply syntactic sugar to it, then INCLUDE it to check it's well-formed.
</p>



</div>
<div class="ribbon_rectangle_h2"><h2>Internal functions</h2> </div>
<div class="ribbon_triangle_h2-l"></div>
<div class="ribbon_triangle_h2-r"></div>
<div class="section">
<p>These should not be called from outside the library itself.</p>
<p><strong>sugar_action()=()</strong> patch<br></p><p>
Handle SFO abbreviations for action functions
</p>
<p><strong>sugar_comparison()=()</strong> patch<br></p><p>
Swap in simpler versions of string comparison
</p>
<p><strong>sugar_decomment()=()</strong> patch<br></p><p>
Remove //-style comments.
</p>
<p><strong>sugar_parse_action_arguments(args:s, input:s, input2:s, struct:s, type:s)=(ints:s, strs:s)</strong> patch<br></p><p>
Preliminary processing: extract the contents of the argument bracket(s)
</p>
<p><strong>sugar_parse_arguments(args1:s, args2:s, input:s, input2:s, struct:s)=(ints:s, strs:s)</strong> patch<br></p><p>
Work out the STR_VAR/INT_VAR part of the function, using info from sugar_parse_[patch|action]_arguments
</p>
<p><strong>sugar_parse_function(function:s)=(input:s, input2:s, function:s, struct:s, output:s, output2:s, type:s, output_array:s)</strong> patch<br></p><p>
Parse the function for virtual-object data
</p>
<p><strong>sugar_parse_fundef_args(args:s)=(ints:s, strs:s)</strong> patch<br></p><p>
Parse the function definition for INT_VARs and STR_VARs
</p>
<p><strong>sugar_parse_fundef_rets(args:s, RET, rets, retarrays)=()</strong> patch<br></p>
<p><strong>sugar_parse_patch_arguments(args:s, input:s, input2:s, struct:s, type:s)=(ints:s, strs:s)</strong> patch<br></p><p>
Exactly like sugar_parse_action_arguments, but with curly brackets instead of square brackets
</p>
<p><strong>sugar_parse_returns(output_array:i, returns:s, output:s, output2:s, struct:s, RET, ret)=()</strong> patch<br></p><p>
Work out the 'RET' and 'RET_ARRAY' section of the function
</p>
<p><strong>sugar_patch()=()</strong> patch<br></p><p>
Handle SFO abbreviations for patch functions
</p>
<p><strong>sugar_remove_inline(quote_index:i)=(quote_index:s, quote_array:a)</strong> patch<br></p><p>
Extract inlined files (so we don't sugar them - main concern: LUA) and store them for later
restoration in the format [unique integer]=string. quote_array tracks how many quotes so far, 
so that sugar_remove_inline and sugar_remove_quintuple_quotes can share. 
</p>
<p><strong>sugar_remove_quintuple_quotes(quote_index:i)=(quote_index:s, quote_array:a)</strong> patch<br></p><p>
Extract the contents of ~~~~~ - ~~~~~ -quoted data (so we don't sugar it - main concern: mangling 
the file when we sugar an anonymous function input to an action function that's itself sugared, e.g.
the cre.edit interface) and store them for later restoration in the format [unique integer]=string. 
quote_array tracks how many quotes so far, so that sugar_remove_inline and sugar_remove_quintuple_quotes can share. </p><p>Incidentally, we don't do single-quoted or tilde-quoted data because in a few cases - e.g
SPRINT var "~" - it will mangle the file.
</p>
<p><strong>sugar_replace_removed_data(quote_array:s)=()</strong> patch<br></p><p>
Put back data sequestered by sugar_remove_[whatever]
</p>
<p><strong>test_sugar_helper()=()</strong> action<br></p><p>Doesn't actually exist: contained in the inline 'sugartext.tp2' (and is well-formed but doesn't work)</p>





</div>



</div>
</div>
</body>