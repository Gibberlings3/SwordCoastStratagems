//////////////////////////////////////////////////////////////////////
////	Cornugon combat script
////////////////////////////////////////////////////////////////////////

INCLUDE FILE(%scsroot%/fiend/ssl/fiend_definitions.ssl)


INCLUDE FILE(%scsroot%/fiend/ssl/initial.ssl)  // rest-and-recover, mill in confusion, etc.

/////////////////////////////////////////////////////////////////////////////////////////
///	Kill Tanar'ri
/////////////////////////////////////////////////////////////////////////////////////////

BEGIN LOOP(scsdemon||CHAOTIC_EVIL)
	INCLUDE FILE(%scsroot%/fiend/ssl/bloodwar.ssl)
END LOOP

////////////////////////////////////////////////////////////////////////////
///	Begin fight with fear aura
////////////////////////////////////////////////////////////////////////////

IF
	See(NearestEnemyOf(Myself))
	!GlobalTimerNotExpired("fearaura","LOCALS")
        !GlobalTimerNotExpired("DMWWTimeStopRunning","GLOBAL")
THEN
	RESPONSE #100
		SetGlobalTimer("fearaura","LOCALS",6)
		ReallyForceSpell(Myself,DEMON_FEAR)
		Continue()
END

//////////////////////////////////////////////////////////////////////////////////////
///	Consider moving to a more interesting location in the battle
//////////////////////////////////////////////////////////////////////////////////////

 INCLUDE FILE(%scsroot%/fiend/ssl/jump.ssl)

//////////////////////////////////////////////////////////////////////////////////////
///	Consider a Dispel Magic
//////////////////////////////////////////////////////////////////////////////////////

  INCLUDE FILE(%scsroot%/fiend/ssl/dispel.ssl)


/////////////////////////////////////////////////////////////////////////////////
////	Lightning Bolt
//////////////////////////////////////////////////////////////////////////////////

IF TRIGGER
        IgnoreBlock(Demivrgvs)
	TargetBlock(PCsInOrder)
	TargetBlock(EnemiesInOrderShort)
	TriggerBlock(Enemy|Disabled|MR100|ResistElectric|SIEvocation)
THEN DO
	Action(Spell,INNATE_FIEND_LIGHTNING_BOLT)
END

IF TRIGGER
        RequireBlock(Demivrgvs)
	TargetBlock(PCsInOrder)
	TargetBlock(EnemiesInOrderShort)
	TriggerBlock(Enemy|Disabled|MR100|ResistElectric|SpellTurn)
THEN DO
	Action(SpellNoDec,INNATE_FIEND_LIGHTNING_BOLT)
END

///////////////////////////////////////////////////////////////////////
// generic combat

///////////////////////////////////////////////////////////////////////////////


BEGIN LOOP(MyWeaponStrength||3)
BEGIN LOOP(MyWeaponDamageType||Slashing)
INCLUDE FILE(%scsroot%/genai/ssl/easy_melee.ssl)
INCLUDE FILE(%scsroot%/genai/ssl/dw#wtacor.ssl)
INCLUDE FILE(%scsroot%/genai/ssl/move.ssl)
INCLUDE FILE(%scsroot%/fiend/ssl/chase.ssl)
END LOOP
END LOOP
